@HEADER-COMMENT@


@HEADER@
BuildRequires:	blocxx-devel boost-devel gcc-c++ libxcrypt-devel openssl-devel sablot swig docbook-xsl-stylesheets doxygen libxslt perl-XML-Writer sgml-skel update-desktop-files yast2 yast2-core-devel yast2-devtools yast2-testsuite yast2-perl-bindings libxml2-devel
Requires:	yast2-storage-lib = %version yast2-perl-bindings mdadm lvm2 dmraid multipath-tools
Requires:	kpartx cryptsetup util-linux >= 2.16 lsscsi
Requires:	yast2-testsuite >= 2.17.0
Requires:	yast2-core >= 2.17.38
Requires:	yast2 >= 2.17.94
Requires:	yast2-libyui >= 2.17.5
Requires:	yast2-dbus-client
Requires:	parted >= 2.2
%ifarch s390 s390x
Requires:	yast2-s390
%endif
PreReq:		%fillup_prereq
Provides:	y2a_fdsk yast2-config-disk
Obsoletes:	y2a_fdsk yast2-config-disk
Provides:	yast2-agent-fdisk yast2-agent-fdisk-devel
Obsoletes:	yast2-agent-fdisk yast2-agent-fdisk-devel
Provides:	yast2-trans-inst-partitioning
Obsoletes:	yast2-trans-inst-partitioning
Provides:	y2t_inst-partitioning
Obsoletes:	y2t_inst-partitioning
Group:          System/YaST
Summary:	-

%description
This package is a part of YaST2. It contains the necessary scripts to
configure disk storage.

@PREP@

@BUILD@
%ifarch s390 s390x
sed -i -e 's/DEVICE_NAMES=".*"/DEVICE_NAMES="path"/' data/sysconfig.storage
%endif

@INSTALL@
rm -f $RPM_BUILD_ROOT/@plugindir@/libpy2StorageCallbacks.la
rm -f $RPM_BUILD_ROOT/@plugindir@/libpy2StorageCallbacks.so
install -d -m 755 $RPM_BUILD_ROOT/var/lock/libstorage

@CLEAN@

%post
%{fillup_only -n storage}

%files
%defattr(-,root,root)

# storage
%dir @yncludedir@/partitioning
@yncludedir@/partitioning/*.ycp
%dir @yncludedir@/storage
@yncludedir@/storage/*.ycp
@clientdir@/inst_custom_part.ycp
@clientdir@/inst_resize_ui.ycp
@clientdir@/inst_resize_dialog.ycp
@clientdir@/inst_do_resize.ycp
@clientdir@/inst_disk.ycp
@clientdir@/inst_target_part.ycp
@clientdir@/inst_disk_proposal.ycp
@clientdir@/inst_target_selection.ycp
@clientdir@/inst_prepdisk.ycp
@clientdir@/storage_finish.ycp
@clientdir@/partitions_proposal.ycp
@clientdir@/disk.ycp
@clientdir@/disk_worker.ycp
@clientdir@/multipath-simple.ycp
@moduledir@/*
@fillupdir@/sysconfig.storage

%dir @ydatadir@
@ydatadir@/*.ycp

%doc %dir @docdir@
%doc @docdir@/README*
%doc @docdir@/COPY*

# agents-scr
@scrconfdir@/*.scr

# libstorage ycp callbacks
@plugindir@/libpy2StorageCallbacks.so.*

# disk
%dir @desktopdir@
@desktopdir@/disk.desktop

# scripts
@ybindir@/check.boot

# perl bindings of libstorage
%{perl_vendorarch}/LibStorage.so

%package lib
Summary:	-
Group:		System/YaST
Provides:	yast2-storage-evms
Obsoletes:	yast2-storage-evms

%description lib
-

%files lib
%defattr(-,root,root)
%{_libdir}/liby2storage.so.*
%dir /var/lock/libstorage

%post lib
/sbin/ldconfig

%postun lib
/sbin/ldconfig

%package devel
Requires:       blocxx-devel libstdc++-devel yast2-storage = %version
Summary:        -
Group:          System/YaST

%description devel
-

%files devel
%defattr(-,root,root)
%{_libdir}/liby2storage.la
%{_libdir}/liby2storage.so
@includedir@
%doc @docdir@/autodocs
%doc @docdir@/examples
%doc @docdir@/libstorage
%doc @docdir@/config.xml.description
